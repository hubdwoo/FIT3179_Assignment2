{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "width": "container",
    "height": "container",
    "background": "darkgray",
    "projection": 
    {
        "type": "albersUsa"
    },
    "params": 
    [{
        "name": "month_selection",
        "value": "March",
        "bind": 
        {
            "input": "select",
            "options": 
            [
                "January",
                "February",
                "March",
                "April",
                "May",
                "June",
                "July",
                "August",
                "September",
                "October",
                "November",
                "December"
            ],
            "labels": 
            [
                "January",
                "February",
                "March",
                "April",
                "May",
                "June",
                "July",
                "August",
                "September",
                "October",
                "November",
                "December"
            ],
            "name": "Month: "
        }
    }],
    "layer": 
    [{
        "data": 
        {
            "url": "https://raw.githubusercontent.com/hubdwoo/FIT3179_Week9/main/js/states-10m.topojson",
            "format":
            {
                "type": "topojson",
                "feature": "states"
            }
        },
        "transform": 
        [{
            "calculate": "'Data is not available in ' + datum.properties.name",
            "as": "Note"
        }],
        "mark":
        {
            "type": "geoshape",
            "fill": "ghostwhite",
            "stroke": "white",
            "strokeWidth": 1
        },
        "encoding": 
        {
            "tooltip":
            {
                "field": "Note"
            }
        }
    },
    {
        "data":
        {
            "url": "https://raw.githubusercontent.com/hubdwoo/FIT3179_Week9/main/Datasets/state_positive_month.csv"
        },
        "transform": 
        [{
            "lookup": "City",
            "from":
            {
                "data":
                {
                    "url": "https://raw.githubusercontent.com/hubdwoo/FIT3179_Week9/main/js/states-10m.topojson",
                    "format":
                    {
                        "type": "topojson",
                        "feature": "states"
                    }
                },
                "key": "properties.name"
            },
            "as": "geo"
        },
        {
            "filter": "datum.month == month_selection"
        }],
        "mark": 
        {
            "type": "geoshape",
            "stroke": "gray",
            "strokeWidth": 1
        },
        "encoding": 
        {
            "shape":
            {
                "field": "geo",
                "type": "geojson"
            },
            "color":
            {
                "field": "positive",
                "type": "quantitative",
                "scale":
                {
                    "scheme": "reds"
                }
            },
            "tooltip":
            [{
                "field": "City",
                "type": "nominal",
                "title": "State"
            },
            {
                "field": "positive",
                "type": "quantitative",
                "title": "Positive tests",
                "format": ","
            }]
        }
    }]
}